# 二次拟合分析说明

## 0.2 定和约束影响的消除

针对不同化学物质选择性数据存在的定和约束问题（即各产物选择性之和为 100%），引入**等距对数比变换 (Isometric Log-Ratio, ILR)** 来消除其影响，避免伪相关。

### ILR 变换公式
\[ILR_i = \\sqrt{\\frac{i}{i+1}} \\ln \\left( \\frac{\\prod_{j=1}^{i} x_j}{x_{i+1}} \\right)]

此变换将成分数据转换到欧氏空间，使其满足无约束条件，以便进行更准确的建模和分析。在后续需要原数据时，也可通过逆变换恢复。

---

### 1. 模型形式
- **基本形式**: \(y = \\beta_0 + \\beta_1 T' + \\beta_2 T'^2 + \\epsilon\)
- **温度中心化**: \(T' = T - 300\)（减少参数相关性，提高数值稳定性）
- **正则化**: 采用 L2 正则化（岭回归）避免小样本导致的过拟合

### 2. 统计检验
- **二次项显著性 t 检验**: 若 p 值小于 0.2 则保留二次项（考虑到样本量小，标准适当放宽）
- **模型整体 F 检验**: \(F = \\frac{MSR}{MSE} \\sim F(2,2)\)，取临界值 \(F_{0.05(2,2)} = 19.0\)，若 \(F > 19\) 则模型显著。

### 3. 关键结果提取
- **U形/倒U形变化**: 自动计算温度极值点。
- **单调变化**: 分析指标随温度变化的单调性（递增/递减）。
- **特征描述**: 对每一种催化剂，结合特征温度点描述指标变化特征。

## 输出结果

### 1. 可视化文件
- `quadratic_analysis_with_ilr.png`: 包含乙醇转化率和C4烯烃选择性的二次拟合曲线及极值点标记的图表。

### 2. 数据文件
- `quadratic_regression_results.csv`: 原始乙醇转化率和C4烯烃选择性的详细二次回归分析结果，包含：
  - 模型系数（\( \\beta_0, \\beta_1, \\beta_2 \)）
  - 统计检验结果（\(R^2\), F 统计量, p 值）
  - 二次项显著性检验
  - 极值点温度和数值
  - 单调性分析

- `ilr_analysis_results.csv`: 经过 ILR 变换后数据的分析结果，主要针对C4烯烃的选择性，包含：
  - ILR-C4烯烃的二次回归模型系数
  - 统计检验结果（\(R^2\), F 统计量, p 值）
  - 二次项显著性检验
  - 极值点温度和数值
  - 单调性分析
  - 各 ILR 分量在不同温度点（250°C, 275°C, 300°C, 325°C, 350°C）下的具体值，便于追溯。

### 3. 分析总结
程序运行后在控制台输出简洁的分析总结：
- 模型整体显著的催化剂组合数量。
- 乙醇转化率和C4烯烃选择性（ILR变换前）保留二次项的催化剂列表。
- C4烯烃选择性（ILR变换后）保留二次项的催化剂列表。
- 详细的极值点信息和变化形态。

## 主要发现

1.  **乙醇转化率**: 绝大多数催化剂呈现出 U 形或倒 U 形变化趋势，极值点主要集中在 240-280°C 区间，表明温度对乙醇转化率存在非线性影响。
2.  **C4烯烃选择性 (原始数据)**: 变化模式多样，部分催化剂呈现U形、递增等不同形态，但其结果可能受到定和约束的伪相关影响。
3.  **C4烯烃选择性 (ILR变换后)**: 提供了消除定和约束后的更可靠的分析结果，可以更真实地反映 C4 烯烃选择性与温度的内在关系。通过对比原始和ILR变换后的 \(R^2\) 值（原始平均 \(R^2\) 0.9791 → ILR平均 \(R^2\) 0.8698），可以看到 ILR 变换虽然可能降低 \(R^2\) 值，但提供了更稳健且无伪相关的数据用于分析。
4.  **二次拟合的必要性**: 相比单纯的线性拟合，二次拟合能更好地捕捉温度-性能的非线性关系，这在许多催化剂组合中通过二次项的显著性得到了验证。
