================================================================================
C4烯烃收率优化分析系统 (按装料方式分别建模)
================================================================================
正在加载和预处理所有数据...
正在加载附件1数据...
正在计算C4烯烃收率...
正在加载和清洗每组指标数据...
正在合并数据表...
正在计算新特征：总质量和装料比...
正在创建装料方式哑变量...
数据预处理完成！最终数据集包含 109 行数据
特征变量：['Y', 'total_mass', 'loading_ratio', 'C', 'C_e', 'M']
目标变量：Y (C4烯烃收率)
✓ 数据加载完成
A系列数据: 69 行
B系列数据: 40 行

================================================================================
开始分析装料方式: A系列
================================================================================

第1步: 获取变量边界
--------------------------------------------------
✓ 连续变量边界:
  T: 250.00 - 450.00
  total_mass: 83.00 - 400.00
  loading_ratio: 0.49 - 2.03
  C: 0.50 - 5.00
  C_e: 0.30 - 2.10

第2步: 特征工程与模型构建
--------------------------------------------------
开始构建响应面模型...
自变量矩阵形状: (69, 5)
目标变量向量形状: (69,)
正在进行数据标准化...
正在生成多项式特征...
多项式特征矩阵形状: (69, 20)
正在使用RidgeCV进行模型拟合与正则化...
✓ RidgeCV模型构建完成
✓ 最佳正则化强度 (alpha): 1.0000
模型在训练集上的R²: 0.9183
交叉验证R²: 0.6501

模型诊断:
均方误差 (MSE): 9.2342
均方根误差 (RMSE): 3.0388
平均绝对误差 (MAE): 2.0243

特征重要性分析:
前10个最重要的特征:
           feature  coefficient  abs_coefficient
0                T     7.115488         7.115488
1       total_mass     3.357215         3.357215
6     T total_mass     3.021947         3.021947
5              T^2     2.507620         2.507620
18           C C_e     2.488337         2.488337
17             C^2    -1.946412         1.946412
13  total_mass C_e     1.241081         1.241081
8              T C    -1.078707         1.078707
4              C_e     0.933509         0.933509
12    total_mass C     0.657526         0.657526

模型稳定性分析:
独立交叉验证R² (5折): 0.6475 (+/- 0.3044)
✅ 模型具有良好的泛化能力
正在将模型方程保存到 model_equation.txt...
✓ 模型方程已成功保存到 model_equation.txt

响应面模型构建完成！
✓ A系列的响应面模型构建完成

第3步: 无约束优化求解
--------------------------------------------------
正在执行无约束优化...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 450°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

优化完成！
最优收率: 54.8464

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 450.00°C
总质量 (total_mass): 400.00 mg
装料比 (loading_ratio): 0.58
Co负载量 (C): 2.08 wt%
乙醇浓度 (C_e): 2.10 ml/min
预测C4烯烃收率: 54.8464

前5个最优组合:

第1名:
  温度: 450.00°C
  总质量: 400.00 mg
  装料比: 0.58
  Co负载量: 2.08 wt%
  乙醇浓度: 2.10 ml/min
  预测收率: 54.8464

最优解中各变量的分布:
T: [np.float64(450.0)]
total_mass: [np.float64(400.0)]
loading_ratio: [np.float64(0.5798497914707401)]
C: [np.float64(2.081606664136559)]
C_e: [np.float64(2.1)]
✓ A系列无约束优化完成

第4步: 约束优化求解 (T < 350°C)
--------------------------------------------------
正在执行约束优化(温度范围: 250.0-350.0°C)...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 350°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

优化完成！
最优收率: 21.8043

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 350.00°C
总质量 (total_mass): 400.00 mg
装料比 (loading_ratio): 0.75
Co负载量 (C): 2.82 wt%
乙醇浓度 (C_e): 2.10 ml/min
预测C4烯烃收率: 21.8043

前5个最优组合:

第1名:
  温度: 350.00°C
  总质量: 400.00 mg
  装料比: 0.75
  Co负载量: 2.82 wt%
  乙醇浓度: 2.10 ml/min
  预测收率: 21.8043

最优解中各变量的分布:
T: [np.float64(350.0)]
total_mass: [np.float64(400.0)]
loading_ratio: [np.float64(0.7499280927758597)]
C: [np.float64(2.8166253595427313)]
C_e: [np.float64(2.1)]
✓ A系列约束优化完成

第5步: 稳健性分析
--------------------------------------------------
--- 正在分析 A系列 无约束最优解的稳健性 ---

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 450.00°C
总质量: 400.00 mg
装料比: 0.58
Co负载量: 2.08 wt%
乙醇浓度: 2.10 ml/min
预测收率: 54.8464

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

基准收率: 54.8464

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           45.7006    64.9010    19.2003    29.58%     低       
总质量          53.0240    56.6722    3.6482     6.44%      中       
装料比          54.8431    54.8464    0.0033     0.01%      高       
Co负载量        54.8359    54.8464    0.0105     0.02%      高       
乙醇浓度         54.5253    55.1622    0.6369     1.15%      高       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 装料比, Co负载量, 乙醇浓度
中等稳健性参数: 总质量
低稳健性参数: 温度

工艺优化建议:
⚠️  需要严格控制以下参数: 温度
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 装料比, Co负载量, 乙醇浓度
   这些参数可以在一定范围内灵活调整，不会显著影响收率。
--- 正在分析 A系列 约束最优解的稳健性 ---

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 350.00°C
总质量: 400.00 mg
装料比: 0.75
Co负载量: 2.82 wt%
乙醇浓度: 2.10 ml/min
预测收率: 21.8043

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

基准收率: 21.8043

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           17.9812    26.1771    8.1959     31.31%     低       
总质量          20.7354    22.8767    2.1413     9.36%      中       
装料比          21.7987    21.8043    0.0056     0.03%      高       
Co负载量        21.7851    21.8043    0.0191     0.09%      高       
乙醇浓度         21.1307    22.4725    1.3418     5.97%      中       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 装料比, Co负载量
中等稳健性参数: 总质量, 乙醇浓度
低稳健性参数: 温度

工艺优化建议:
⚠️  需要严格控制以下参数: 温度
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 装料比, Co负载量
   这些参数可以在一定范围内灵活调整，不会显著影响收率。

================================================================================
开始分析装料方式: B系列
================================================================================

第1步: 获取变量边界
--------------------------------------------------
✓ 连续变量边界:
  T: 250.00 - 400.00
  total_mass: 83.00 - 400.00
  loading_ratio: 0.49 - 2.03
  C: 0.50 - 5.00
  C_e: 0.30 - 2.10

第2步: 特征工程与模型构建
--------------------------------------------------
开始构建响应面模型...
自变量矩阵形状: (40, 5)
目标变量向量形状: (40,)
正在进行数据标准化...
正在生成多项式特征...
多项式特征矩阵形状: (40, 20)
正在使用RidgeCV进行模型拟合与正则化...
✓ RidgeCV模型构建完成
✓ 最佳正则化强度 (alpha): 1.0000
模型在训练集上的R²: 0.9365
交叉验证R²: 0.7029

模型诊断:
均方误差 (MSE): 2.4407
均方根误差 (RMSE): 1.5623
平均绝对误差 (MAE): 1.1947

特征重要性分析:
前10个最重要的特征:
           feature  coefficient  abs_coefficient
0                T     3.675472         3.675472
5              T^2     2.595390         2.595390
6     T total_mass     1.672885         1.672885
1       total_mass     1.165511         1.165511
4              C_e    -0.933902         0.933902
10    total_mass^2    -0.928430         0.928430
9            T C_e    -0.648068         0.648068
13  total_mass C_e    -0.183943         0.183943
19           C_e^2    -0.092118         0.092118
3                C     0.000000         0.000000

模型稳定性分析:
独立交叉验证R² (5折): 0.6302 (+/- 0.5071)
✅ 模型具有良好的泛化能力
正在将模型方程保存到 model_equation.txt...
✓ 模型方程已成功保存到 model_equation.txt

响应面模型构建完成！
✓ B系列的响应面模型构建完成

第3步: 无约束优化求解
--------------------------------------------------
正在执行无约束优化...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 400°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

优化完成！
最优收率: 27.5336

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 400.00°C
总质量 (total_mass): 278.55 mg
装料比 (loading_ratio): 1.12
Co负载量 (C): 4.22 wt%
乙醇浓度 (C_e): 0.30 ml/min
预测C4烯烃收率: 27.5336

前5个最优组合:

第1名:
  温度: 400.00°C
  总质量: 278.55 mg
  装料比: 1.12
  Co负载量: 4.22 wt%
  乙醇浓度: 0.30 ml/min
  预测收率: 27.5336

最优解中各变量的分布:
T: [np.float64(400.0)]
total_mass: [np.float64(278.54773566018014)]
loading_ratio: [np.float64(1.1225528918406043)]
C: [np.float64(4.221290059078953)]
C_e: [np.float64(0.3)]
✓ B系列无约束优化完成

第4步: 约束优化求解 (T < 350°C)
--------------------------------------------------
正在执行约束优化(温度范围: 250.0-350.0°C)...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 350°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

优化完成！
最优收率: 11.9784

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 350.00°C
总质量 (total_mass): 220.58 mg
装料比 (loading_ratio): 1.91
Co负载量 (C): 4.98 wt%
乙醇浓度 (C_e): 0.30 ml/min
预测C4烯烃收率: 11.9784

前5个最优组合:

第1名:
  温度: 350.00°C
  总质量: 220.58 mg
  装料比: 1.91
  Co负载量: 4.98 wt%
  乙醇浓度: 0.30 ml/min
  预测收率: 11.9784

最优解中各变量的分布:
T: [np.float64(350.0)]
total_mass: [np.float64(220.58319528872212)]
loading_ratio: [np.float64(1.908731017729625)]
C: [np.float64(4.980011752355871)]
C_e: [np.float64(0.3)]
✓ B系列约束优化完成

第5步: 稳健性分析
--------------------------------------------------
--- 正在分析 B系列 无约束最优解的稳健性 ---

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 400.00°C
总质量: 278.55 mg
装料比: 1.12
Co负载量: 4.22 wt%
乙醇浓度: 0.30 ml/min
预测收率: 27.5336

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

基准收率: 27.5336

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           20.4048    35.4772    15.0724    42.48%     低       
总质量          27.4909    27.5336    0.0427     0.16%      高       
装料比          27.5336    27.5336    0.0000     0.00%      高       
Co负载量        27.5336    27.5336    0.0000     0.00%      高       
乙醇浓度         27.4560    27.6109    0.1549     0.56%      高       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 总质量, 装料比, Co负载量, 乙醇浓度
低稳健性参数: 温度

工艺优化建议:
⚠️  需要严格控制以下参数: 温度
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 总质量, 装料比, Co负载量, 乙醇浓度
   这些参数可以在一定范围内灵活调整，不会显著影响收率。
--- 正在分析 B系列 约束最优解的稳健性 ---

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 350.00°C
总质量: 220.58 mg
装料比: 1.91
Co负载量: 4.98 wt%
乙醇浓度: 0.30 ml/min
预测收率: 11.9784

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

基准收率: 11.9784

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           7.9959     16.5848    8.5889     51.79%     低       
总质量          11.9517    11.9784    0.0268     0.22%      高       
装料比          11.9784    11.9784    0.0000     0.00%      高       
Co负载量        11.9784    11.9784    0.0000     0.00%      高       
乙醇浓度         11.9365    12.0200    0.0836     0.70%      高       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 总质量, 装料比, Co负载量, 乙醇浓度
低稳健性参数: 温度

工艺优化建议:
⚠️  需要严格控制以下参数: 温度
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 总质量, 装料比, Co负载量, 乙醇浓度
   这些参数可以在一定范围内灵活调整，不会显著影响收率。

================================================================================
最终结果对比分析
================================================================================

--- 无约束优化对比 (追求最高收率) ---
  - A系列:
    - 预测收率: 54.85%
    - 工艺条件: T=450.0°C, 总质量=400.0mg, 装料比=0.58, Co负载量=2.08wt%, 乙醇浓度=2.10ml/min
  - B系列:
    - 预测收率: 27.53%
    - 工艺条件: T=400.0°C, 总质量=278.5mg, 装料比=1.12, Co负载量=4.22wt%, 乙醇浓度=0.30ml/min

--- 约束优化对比 (T < 350°C) ---
  - A系列 (T<350°C):
    - 预测收率: 21.80%
    - 工艺条件: T=350.0°C, 总质量=400.0mg, 装料比=0.75, Co负载量=2.82wt%, 乙醇浓度=2.10ml/min
  - B系列 (T<350°C):
    - 预测收率: 11.98%
    - 工艺条件: T=350.0°C, 总质量=220.6mg, 装料比=1.91, Co负载量=4.98wt%, 乙醇浓度=0.30ml/min

================================================================================
分析完成！
================================================================================
