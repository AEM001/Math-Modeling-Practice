================================================================================
C4烯烃收率优化分析系统 (按装料方式分别建模)
================================================================================
正在加载和预处理所有数据...
正在加载附件1数据...
正在计算C4烯烃收率...
正在加载和清洗每组指标数据...
正在合并数据表...
正在计算新特征：总质量和装料比...
正在创建装料方式哑变量...
数据预处理完成！最终数据集包含 109 行数据
特征变量：['Y', 'total_mass', 'loading_ratio', 'C', 'C_e', 'M']
目标变量：Y (C4烯烃收率)
✓ 数据加载完成
A系列数据: 69 行
B系列数据: 40 行

================================================================================
开始分析装料方式: A系列
================================================================================

第1步: 获取变量边界
--------------------------------------------------
✓ 连续变量边界:
  T: 250.00 - 450.00
  total_mass: 83.00 - 400.00
  loading_ratio: 0.49 - 2.03
  C: 0.50 - 5.00
  C_e: 0.30 - 2.10

第2步: 特征工程与模型构建
--------------------------------------------------
开始构建响应面模型...
自变量矩阵形状: (69, 5)
目标变量向量形状: (69,)
正在进行数据归一化 (Min-Max Scaling)...
正在生成多项式特征...
多项式特征矩阵形状: (69, 20)
正在使用RidgeCV进行模型拟合与正则化...
✓ RidgeCV模型构建完成
✓ 最佳正则化强度 (alpha): 0.0100
模型在训练集上的R²: 0.9187
交叉验证R²: 0.7327

模型诊断:
均方误差 (MSE): 9.1834
均方根误差 (RMSE): 3.0304
平均绝对误差 (MAE): 2.0257

特征重要性分析:
前10个最重要的特征:
            feature  coefficient  abs_coefficient
5               T^2    34.572257        34.572257
18            C C_e    27.244825        27.244825
6      T total_mass    23.167313        23.167313
17              C^2   -20.156206        20.156206
8               T C   -12.968749        12.968749
14  loading_ratio^2    -8.139984         8.139984
4               C_e    -7.502019         7.502019
13   total_mass C_e     7.460022         7.460022
2     loading_ratio     7.181316         7.181316
12     total_mass C     4.986597         4.986597

模型稳定性分析:
独立交叉验证R² (5折): 0.7060 (+/- 0.3178)
✅ 模型具有良好的泛化能力
正在将模型方程保存到 model_equation.txt...
✓ 模型方程已成功保存到 model_equation.txt

响应面模型构建完成！
✓ A系列的响应面模型构建完成

第3步: 无约束优化求解
--------------------------------------------------
正在执行无约束优化...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 450°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

优化完成！
最优收率: 55.2023

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 450.00°C
总质量 (total_mass): 400.00 mg
装料比 (loading_ratio): 0.70
Co负载量 (C): 0.50 wt%
乙醇浓度 (C_e): 0.30 ml/min
预测C4烯烃收率: 55.2023

前5个最优组合:

第1名:
  温度: 450.00°C
  总质量: 400.00 mg
  装料比: 0.70
  Co负载量: 0.50 wt%
  乙醇浓度: 0.30 ml/min
  预测收率: 55.2023

最优解中各变量的分布:
T: [np.float64(450.0)]
total_mass: [np.float64(400.0)]
loading_ratio: [np.float64(0.6958567682608078)]
C: [np.float64(0.5)]
C_e: [np.float64(0.3)]
✓ A系列无约束优化完成

第4步: 约束优化求解 (T < 350°C)
--------------------------------------------------
正在执行约束优化(温度范围: 250.0-350.0°C)...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 350°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

优化完成！
最优收率: 22.5008

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 350.00°C
总质量 (total_mass): 400.00 mg
装料比 (loading_ratio): 1.15
Co负载量 (C): 2.88 wt%
乙醇浓度 (C_e): 2.10 ml/min
预测C4烯烃收率: 22.5008

前5个最优组合:

第1名:
  温度: 350.00°C
  总质量: 400.00 mg
  装料比: 1.15
  Co负载量: 2.88 wt%
  乙醇浓度: 2.10 ml/min
  预测收率: 22.5008

最优解中各变量的分布:
T: [np.float64(350.0)]
total_mass: [np.float64(400.0)]
loading_ratio: [np.float64(1.1456841948435876)]
C: [np.float64(2.8831783296480227)]
C_e: [np.float64(2.1)]
✓ A系列约束优化完成

第5步: 稳健性分析
--------------------------------------------------
--- 正在分析 A系列 无约束最优解的稳健性 ---

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 450.00°C
总质量: 400.00 mg
装料比: 0.70
Co负载量: 0.50 wt%
乙醇浓度: 0.30 ml/min
预测收率: 55.2023

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

基准收率: 55.2023

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           45.1930    66.0867    20.8937    31.62%     低       
总质量          54.2336    56.1451    1.9115     3.40%      高       
装料比          55.1981    55.2023    0.0042     0.01%      高       
Co负载量        55.1338    55.2695    0.1357     0.25%      高       
乙醇浓度         55.1686    55.2360    0.0674     0.12%      高       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 总质量, 装料比, Co负载量, 乙醇浓度
低稳健性参数: 温度

工艺优化建议:
⚠️  需要严格控制以下参数: 温度
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 总质量, 装料比, Co负载量, 乙醇浓度
   这些参数可以在一定范围内灵活调整，不会显著影响收率。
--- 正在分析 A系列 约束最优解的稳健性 ---

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 350.00°C
总质量: 400.00 mg
装料比: 1.15
Co负载量: 2.88 wt%
乙醇浓度: 2.10 ml/min
预测收率: 22.5008

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

基准收率: 22.5008

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           18.7556    26.7754    8.0198     29.95%     低       
总质量          21.6496    23.3261    1.6765     7.19%      中       
装料比          22.4895    22.5008    0.0113     0.05%      高       
Co负载量        22.4801    22.5008    0.0207     0.09%      高       
乙醇浓度         21.6594    23.3455    1.6861     7.22%      中       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 装料比, Co负载量
中等稳健性参数: 总质量, 乙醇浓度
低稳健性参数: 温度

工艺优化建议:
⚠️  需要严格控制以下参数: 温度
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 装料比, Co负载量
   这些参数可以在一定范围内灵活调整，不会显著影响收率。

================================================================================
开始分析装料方式: B系列
================================================================================

第1步: 获取变量边界
--------------------------------------------------
✓ 连续变量边界:
  T: 250.00 - 400.00
  total_mass: 83.00 - 400.00
  loading_ratio: 0.49 - 2.03
  C: 0.50 - 5.00
  C_e: 0.30 - 2.10

第2步: 特征工程与模型构建
--------------------------------------------------
开始构建响应面模型...
自变量矩阵形状: (40, 5)
目标变量向量形状: (40,)
正在进行数据归一化 (Min-Max Scaling)...
正在生成多项式特征...
多项式特征矩阵形状: (40, 20)
正在使用RidgeCV进行模型拟合与正则化...
✓ RidgeCV模型构建完成
✓ 最佳正则化强度 (alpha): 0.1000
模型在训练集上的R²: 0.9252
交叉验证R²: 0.7899

模型诊断:
均方误差 (MSE): 2.8777
均方根误差 (RMSE): 1.6964
平均绝对误差 (MAE): 1.1717

特征重要性分析:
前10个最重要的特征:
           feature  coefficient  abs_coefficient
5              T^2    17.774091        17.774091
6     T total_mass    11.693918        11.693918
9            T C_e    -7.255503         7.255503
0                T    -5.562803         5.562803
10    total_mass^2    -4.932681         4.932681
1       total_mass     2.916096         2.916096
13  total_mass C_e     0.943527         0.943527
4              C_e    -0.663072         0.663072
19           C_e^2     0.088959         0.088959
3                C     0.000000         0.000000

模型稳定性分析:
独立交叉验证R² (5折): 0.6885 (+/- 0.5482)
✅ 模型具有良好的泛化能力
正在将模型方程保存到 model_equation.txt...
✓ 模型方程已成功保存到 model_equation.txt

响应面模型构建完成！
✓ B系列的响应面模型构建完成

第3步: 无约束优化求解
--------------------------------------------------
正在执行无约束优化...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 400°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

优化完成！
最优收率: 26.7451

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 400.00°C
总质量 (total_mass): 277.96 mg
装料比 (loading_ratio): 1.13
Co负载量 (C): 3.25 wt%
乙醇浓度 (C_e): 0.30 ml/min
预测C4烯烃收率: 26.7451

前5个最优组合:

第1名:
  温度: 400.00°C
  总质量: 277.96 mg
  装料比: 1.13
  Co负载量: 3.25 wt%
  乙醇浓度: 0.30 ml/min
  预测收率: 26.7451

最优解中各变量的分布:
T: [np.float64(400.0)]
total_mass: [np.float64(277.96266979986694)]
loading_ratio: [np.float64(1.1337136365029072)]
C: [np.float64(3.248248722417454)]
C_e: [np.float64(0.3)]
✓ B系列无约束优化完成

第4步: 约束优化求解 (T < 350°C)
--------------------------------------------------
正在执行约束优化(温度范围: 250.0-350.0°C)...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 350°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

优化完成！
最优收率: 12.6994

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 350.00°C
总质量 (total_mass): 206.84 mg
装料比 (loading_ratio): 1.65
Co负载量 (C): 1.09 wt%
乙醇浓度 (C_e): 0.30 ml/min
预测C4烯烃收率: 12.6994

前5个最优组合:

第1名:
  温度: 350.00°C
  总质量: 206.84 mg
  装料比: 1.65
  Co负载量: 1.09 wt%
  乙醇浓度: 0.30 ml/min
  预测收率: 12.6994

最优解中各变量的分布:
T: [np.float64(350.0)]
total_mass: [np.float64(206.84044336443975)]
loading_ratio: [np.float64(1.6508615893297087)]
C: [np.float64(1.0944840880737057)]
C_e: [np.float64(0.3)]
✓ B系列约束优化完成

第5步: 稳健性分析
--------------------------------------------------
--- 正在分析 B系列 无约束最优解的稳健性 ---

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 400.00°C
总质量: 277.96 mg
装料比: 1.13
Co负载量: 3.25 wt%
乙醇浓度: 0.30 ml/min
预测收率: 26.7451

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

基准收率: 26.7451

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           20.3448    33.7774    13.4325    39.77%     低       
总质量          26.7157    26.7451    0.0294     0.11%      高       
装料比          26.7451    26.7451    0.0000     0.00%      高       
Co负载量        26.7451    26.7451    0.0000     0.00%      高       
乙醇浓度         26.6619    26.8283    0.1664     0.62%      高       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 总质量, 装料比, Co负载量, 乙醇浓度
低稳健性参数: 温度

工艺优化建议:
⚠️  需要严格控制以下参数: 温度
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 总质量, 装料比, Co负载量, 乙醇浓度
   这些参数可以在一定范围内灵活调整，不会显著影响收率。
--- 正在分析 B系列 约束最优解的稳健性 ---

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 350.00°C
总质量: 206.84 mg
装料比: 1.65
Co负载量: 1.09 wt%
乙醇浓度: 0.30 ml/min
预测收率: 12.6994

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

基准收率: 12.6994

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           8.9861     16.8966    7.9105     46.82%     低       
总质量          12.6832    12.6994    0.0163     0.13%      高       
装料比          12.6994    12.6994    0.0000     0.00%      高       
Co负载量        12.6994    12.6994    0.0000     0.00%      高       
乙醇浓度         12.6418    12.7571    0.1152     0.90%      高       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 总质量, 装料比, Co负载量, 乙醇浓度
低稳健性参数: 温度

工艺优化建议:
⚠️  需要严格控制以下参数: 温度
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 总质量, 装料比, Co负载量, 乙醇浓度
   这些参数可以在一定范围内灵活调整，不会显著影响收率。

================================================================================
最终结果对比分析
================================================================================

--- 无约束优化对比 (追求最高收率) ---
  - A系列:
    - 预测收率: 55.20%
    - 工艺条件: T=450.0°C, 总质量=400.0mg, 装料比=0.70, Co负载量=0.50wt%, 乙醇浓度=0.30ml/min
  - B系列:
    - 预测收率: 26.75%
    - 工艺条件: T=400.0°C, 总质量=278.0mg, 装料比=1.13, Co负载量=3.25wt%, 乙醇浓度=0.30ml/min

--- 约束优化对比 (T < 350°C) ---
  - A系列 (T<350°C):
    - 预测收率: 22.50%
    - 工艺条件: T=350.0°C, 总质量=400.0mg, 装料比=1.15, Co负载量=2.88wt%, 乙醇浓度=2.10ml/min
  - B系列 (T<350°C):
    - 预测收率: 12.70%
    - 工艺条件: T=350.0°C, 总质量=206.8mg, 装料比=1.65, Co负载量=1.09wt%, 乙醇浓度=0.30ml/min

================================================================================
分析完成！
================================================================================
