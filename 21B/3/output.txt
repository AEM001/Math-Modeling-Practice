(base) Mac@Albert 3 % python main.py
================================================================================
C4烯烃收率优化分析系统
================================================================================
基于响应面模型（RSM）的工艺条件优化
使用RidgeCV正则化回归提升模型泛化能力
特征工程：总质量和装料比
================================================================================

第1步：项目设置与环境准备
--------------------------------------------------
✓ 附件1数据文件: 附件1.csv
✓ 每组指标文件: 每组指标.csv

第2步：数据加载与预处理
--------------------------------------------------
正在加载附件1数据...
正在计算C4烯烃收率...
正在加载和清洗每组指标数据...
正在合并数据表...
正在计算新特征：总质量和装料比...
正在创建装料方式哑变量...
数据预处理完成！最终数据集包含 109 行数据
特征变量：['Y', 'total_mass', 'loading_ratio', 'C', 'C_e', 'M']
目标变量：Y (C4烯烃收率)
✓ 数据预处理完成
✓ 连续变量边界:
  T: 250.0 - 450.0
  total_mass: 83.0 - 400.0
  loading_ratio: 0.5 - 2.0
  C: 0.5 - 5.0
  C_e: 0.3 - 2.1
✓ 离散变量选项:
  M: [0, 1]

第3步：特征工程与模型构建
--------------------------------------------------
开始构建响应面模型...
自变量矩阵形状: (109, 6)
目标变量向量形状: (109,)
正在进行数据标准化...
正在生成多项式特征...
多项式特征矩阵形状: (109, 27)
正在使用RidgeCV进行模型拟合与正则化...
✓ RidgeCV模型构建完成
✓ 最佳正则化强度 (alpha): 10.0000
模型在训练集上的R²: 0.9126
交叉验证R²: 0.7265

模型诊断:
均方误差 (MSE): 7.7932
均方根误差 (RMSE): 2.7916
平均绝对误差 (MAE): 1.7499

特征重要性分析:
前10个最重要的特征:
           feature  coefficient  abs_coefficient
0                T     5.398663         5.398663
7     T total_mass     2.570486         2.570486
1       total_mass     2.527195         2.527195
6              T^2     2.514893         2.514893
15  total_mass C_e     0.983304         0.983304
22           C C_e     0.932913         0.932913
21             C^2    -0.813317         0.813317
9              T C    -0.738532         0.738532
5                M    -0.701212         0.701212
10           T C_e    -0.582909         0.582909

模型稳定性分析:
独立交叉验证R² (5折): 0.7250 (+/- 0.3002)
✅ 模型具有良好的泛化能力
正在将模型方程保存到 model_equation.txt...
✓ 模型方程已成功保存到 model_equation.txt

响应面模型构建完成！
✓ 响应面模型构建完成

第4步：无约束优化求解
--------------------------------------------------
正在执行无约束优化...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 450°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
需要为 2 种装料方式分别进行优化
每个装料方式将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

正在为装料方式 M=0 ('A系列') 进行优化...

正在为装料方式 M=1 ('B系列') 进行优化...

优化完成！
最优收率: 53.7108

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 450.00°C
总质量 (total_mass): 400.00 mg
装料比 (loading_ratio): 0.62
Co负载量 (C): 0.5 wt%
乙醇浓度 (C_e): 0.3 ml/min
装料方式 (M): A系列
预测C4烯烃收率: 53.7108

前5个最优组合:

第1名:
  温度: 450.00°C
  总质量: 400.00 mg
  装料比: 0.62
  Co负载量: 0.5 wt%
  乙醇浓度: 0.3 ml/min
  装料方式: A系列
  预测收率: 53.7108

第2名:
  温度: 450.00°C
  总质量: 400.00 mg
  装料比: 0.58
  Co负载量: 0.5 wt%
  乙醇浓度: 0.3 ml/min
  装料方式: B系列
  预测收率: 49.4350

最优解中各变量的分布:
T: [np.float64(450.0)]
total_mass: [np.float64(400.0)]
loading_ratio: [np.float64(0.5760927468068076), np.float64(0.6185753099705785)]
C: [np.float64(0.5)]
C_e: [np.float64(0.3)]
M: [np.int64(0), np.int64(1)]
✓ 无约束优化完成

第5步：约束优化求解
--------------------------------------------------
正在执行约束优化（温度范围：250-350°C）...
开始寻找最优工艺条件 (采用多起点优化策略)...
温度范围: 250°C - 350°C
总质量范围: 83 - 400 mg
装料比范围: 0.49 - 2.03
Co负载量范围: 0.5 - 5.0 wt%
乙醇浓度范围: 0.3 - 2.1 ml/min
需要为 2 种装料方式分别进行优化
每个装料方式将使用 20 个随机起点进行优化，以增加找到全局最优解的概率。

正在为装料方式 M=0 ('A系列') 进行优化...

正在为装料方式 M=1 ('B系列') 进行优化...

优化完成！
最优收率: 18.2277

==================================================
优化结果分析
==================================================

最优工艺条件:
温度 (T): 350.00°C
总质量 (total_mass): 400.00 mg
装料比 (loading_ratio): 0.84
Co负载量 (C): 2.3358075821092963 wt%
乙醇浓度 (C_e): 2.1 ml/min
装料方式 (M): A系列
预测C4烯烃收率: 18.2277

前5个最优组合:

第1名:
  温度: 350.00°C
  总质量: 400.00 mg
  装料比: 0.84
  Co负载量: 2.3358075821092963 wt%
  乙醇浓度: 2.1 ml/min
  装料方式: A系列
  预测收率: 18.2277

第2名:
  温度: 350.00°C
  总质量: 400.00 mg
  装料比: 0.80
  Co负载量: 2.454199535470624 wt%
  乙醇浓度: 2.1 ml/min
  装料方式: B系列
  预测收率: 14.9235

最优解中各变量的分布:
T: [np.float64(350.0)]
total_mass: [np.float64(400.0)]
loading_ratio: [np.float64(0.7977158803911498), np.float64(0.8439453061503246)]
C: [np.float64(2.3358075821092963), np.float64(2.454199535470624)]
C_e: [np.float64(2.1)]
M: [np.int64(0), np.int64(1)]
✓ 约束优化完成

第6步：稳健性分析
--------------------------------------------------
正在分析无约束最优解的稳健性...

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 450.00°C
总质量: 400.00 mg
装料比: 0.62
Co负载量: 0.5 wt%
乙醇浓度: 0.3 ml/min
装料方式: A系列
预测收率: 53.7108

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

正在分析 装料方式 的稳健性...

基准收率: 53.7108

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           43.5626    64.8007    21.2381    32.77%     低       
总质量          52.5650    54.8645    2.2995     4.19%      高       
装料比          53.7066    53.7108    0.0042     0.01%      高       
Co负载量        53.6678    53.7531    0.0853     0.16%      高       
乙醇浓度         53.6885    53.7330    0.0445     0.08%      高       
装料方式         49.4271    53.7108    4.2837     7.98%      中       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 总质量, 装料比, Co负载量, 乙醇浓度
中等稳健性参数: 装料方式
低稳健性参数: 温度

工艺优化建议:
⚠️  需要严格控制以下参数: 温度
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 总质量, 装料比, Co负载量, 乙醇浓度
   这些参数可以在一定范围内灵活调整，不会显著影响收率。

正在分析约束最优解的稳健性...

============================================================
稳健性分析报告
============================================================

基准最优解:
温度: 350.00°C
总质量: 400.00 mg
装料比: 0.84
Co负载量: 2.3358075821092963 wt%
乙醇浓度: 2.1 ml/min
装料方式: A系列
预测收率: 18.2277

正在分析 温度 的稳健性...

正在分析 总质量 的稳健性...

正在分析 装料比 的稳健性...

正在分析 Co负载量 的稳健性...

正在分析 乙醇浓度 的稳健性...

正在分析 装料方式 的稳健性...

基准收率: 18.2277

参数扰动对收率的影响:
--------------------------------------------------------------------------------
参数           最小值        最大值        变化范围       相对变化       稳健性     
--------------------------------------------------------------------------------
温度           14.6180    22.4071    7.7891     34.76%     低       
总质量          17.2957    19.1676    1.8719     9.77%      中       
装料比          18.2199    18.2277    0.0078     0.04%      高       
Co负载量        18.2197    18.2277    0.0080     0.04%      高       
乙醇浓度         17.9740    18.4741    0.5001     2.71%      高       
装料方式         14.9075    18.2277    3.3202     18.22%     低       
--------------------------------------------------------------------------------

稳健性总结:
高稳健性参数: 装料比, Co负载量, 乙醇浓度
中等稳健性参数: 总质量
低稳健性参数: 温度, 装料方式

工艺优化建议:
⚠️  需要严格控制以下参数: 温度, 装料方式
   建议在生产过程中对这些参数进行实时监控和精确控制。
✅ 以下参数具有高稳健性: 装料比, Co负载量, 乙醇浓度
   这些参数可以在一定范围内灵活调整，不会显著影响收率。
✓ 稳健性分析完成

================================================================================
分析结果总结
================================================================================

优化结果对比:
无约束最优收率: 53.7108
约束最优收率: 18.2277
收率下降: 35.4831 (66.06%)

工艺优化建议:
❌ 温度约束对收率影响较大，建议重新评估温度约束的必要性
   建议：考虑采用其他安全措施，而不是严格限制温度

最终推荐方案:
推荐采用无约束优化方案

推荐工艺条件:
温度: 450.00°C
总质量: 400.00 mg
装料比: 0.62
Co负载量: 0.5 wt%
乙醇浓度: 0.3 ml/min
装料方式: A系列
预测C4烯烃收率: 53.7108

================================================================================
分析完成！
================================================================================
