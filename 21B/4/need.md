# 题目要求
B题 乙醇偶合制备 C4 烯烃
C4 烯烃广泛应用于化工产品及医药的生产,乙醇是生产制备C4 烯烃的原料。 在制备过程中,催化剂组合(即:Co 负载量、Co/SiO2 和 HAP 装料比、乙醇浓度 的组合)与温度对 C4 烯烃的选择性和C4 烯烃收率将产生影响(名词解释见附录)。 因此通过对催化剂组合设计,探索乙醇催化偶合制备 C4 烯烃的工艺条件具有非常 重要的意义和价值。
某化工实验室针对不同催化剂在不同温度下做了一系列实验,结果如附件1和 附件2所示。请通过数学建模完成下列问题:

待解决：4:如果允许再增加5次实验,应如何设计,并给出详细理由。

# 名词解释与附件说明
温度:反应温度。
选择性:某一个产物在所有产物中的占比。
时间:催化剂在乙醇氛围下的反应时间,单位分钟(min)。
Co 负载量:Co 与 SiO2 的重量之比。例如,“Co负载量为1wt%”表示 Co 与 SiO2 的重量之比为1:100,记作“1wt%Co/SiO2”,依次类推。
HAP:一种催化剂载体,中文名称羟基磷灰石。
Co /SiO2 和 HAP 装料比:指 Co/SiO2 和 HAP 的质量比。例如附件1 中编号为 A14 的催化剂组合“33mg 1wt%Co/SiO2-67mg HAP-乙醇浓度 1.68ml/min”指 Co/SiO2 和 HAP 质量比为33mg:67mg 且乙醇按每分钟 1.68 毫升加入,依次类推。
乙醇转化率:单位时间内乙醇的单程转化率,其值为 100%×(乙醇进气量-乙 醇剩余量)/乙醇进气量。
C4 烯烃收率:其值为乙醇转化率 x C4 烯烃的选择性。
附件 1:性能数据表。表中乙烯、C4 烯烃、乙醛、碳数为 4-12 脂肪醇等均为 反应的生成物;编号A1-A14 的催化剂实验中使用装料方式 I,B1~B7的催化剂实 验中使用装料方式Ⅱ。
附件2:350度时给定的某种催化剂组合的测试数据。

# 路径
/Users/Mac/Downloads/Math-Modeling-Practice/21B/3/附件1.csv
/Users/Mac/Downloads/Math-Modeling-Practice/21B/附件2.csv
催化剂具体指标：
/Users/Mac/Downloads/Math-Modeling-Practice/21B/3/每组指标.csv
工作目录：/Users/Mac/Downloads/Math-Modeling-Practice/21B/4

# 初步思路
采用的变量：Co 负载量、Co/SiO2 和 HAP 装料比、Co/SiO2 和 HAP 质量之和（需要计算）、乙醇浓度、温度


## 4.1 构建 GPR 模型
问题 4 需要找到最优的 5 组实验条件组合，使得增加这 5 次实验能够实现最大化收益。综合考虑前面几个问题的引导方向，此处考虑选择的实验点能够最大化帮助提高模型拟合精度和搜索收率最大值点。此处采用先构建 GPR 模型后使用 EI 准则选取最优实验点的方法。

**4.1 构建 GPR 模型**
GPR 模型相比线性回归或响应面模型，能够更好地捕捉变量间的非线性交互关系，同时能够输出预测值的不确定性，为 EI 提供较为可靠的分析依据。

**4.1.1 核函数选择**
采用平方指数核（RBF 核）来捕捉非线性关系。RBF 核的基本形式为：

$$
k(x_i, x_j) = \sigma_f^2 \exp\Bigl(-\tfrac{1}{2}\sum_{d=1}^{5}\frac{(x_{i,d}-x_{j,d})^2}{l_d^2}\Bigr)
$$

其中 $\sigma_f^2$ 为信号方差，描述收率的整体波动幅度，在核函数中用于放大或缩小样本点之间的相关性。$l_d$ 为不同自变量的长度尺度，用于控制该变量输入数据的变化对收率预测的影响程度。

**4.1.2 参数优化**
通过极大似然估计 (MLE) 优化核函数的参数 $\sigma_f^2$、$l_d$ 和噪声方差 $\sigma_n^2$，优化目标是使负对数似然取最小：

$$
\mathcal{L} = \frac{1}{2}\log\lvert K\rvert
  + \frac{1}{2}\,y^\mathsf{T}K^{-1}y
  + \frac{n}{2}\log(2\pi)
$$

其中 $K$ 为核矩阵，$y$ 为收率向量，$n$ 为样本量。

**4.1.3 模型验证**
采用 5 折交叉验证。分别计算决定系数 $R^2$ 和均方根误差 (RMSE)，据此评估模型拟合能力。这里要求满足 $R^2>0.7$。


### 4.2 基于 EI 准则筛选实验点

通过计算实验点的 EI 值，并结合 EI 值和 GPR 模型预测的不确定性来选取实验点，既关注了可能的高收率点，也关注了不确定性高的区域，使得选取的实验点能够有较好的价值。

#### 4.2.1 生成候选实验点

根据附件 1 中实验数据拟定各自变量取值范围，并采用拉丁超立方抽样 LHS 生成 1000 个候选实验点。

#### 4.2.2 计算候选实验点 EI 值

对于实验点 x，对应的 EI 值定义为期望值：

$$
\text{EI}(x) = \mathbb{E}[\max(Y(x) - Y_{\text{best}}, 0)]
$$

其中 $Y_{\text{best}}$ 为附件 1 中已有实验的最高收率，$Y(x)$ 为前面的 GPR 模型对候选点 x 的预测收率，该预测值服从正态分布 $N(\mu(x), \sigma^2(x))$。

可以推出 EI 的解析表达式为：

$$
\text{EI}(x) = (\mu(x) - Y_{\text{best}}) \Phi\left( \frac{\mu(x) - Y_{\text{best}}}{\sigma(x)} \right) + \sigma(x) \varphi\left( \frac{\mu(x) - Y_{\text{best}}}{\sigma(x)} \right)
$$

其中 $\Phi(\cdot)$、$\varphi(\cdot)$ 分别为标准正态分布的累积分布函数和概率密度函数。

对每个候选实验点，通过 GPR 模型得到 $\mu(x)$ 和 $\sigma(x)$，代入 EI 公式计算函数值。

#### 4.2.3 实验点筛选

选择 EI 值显著高的 5 个点，并且额外强调优先满足以下条件：

* 预测收率 $\mu(x)$ 高于当前最好值 $Y_{\text{best}}$，选择此实验点能够对收率最高实验点的探索提供潜在候选条件；
* 预测标准差 $\sigma(x)$ 较大，即对于该实验点的预测不确定性高，进行实验获取数据能够有效降低模型不确定性；
* 与已有实验点的实验条件组合差异较显著，尽可能避免数据组合的重复，提高进行额外实验的价值。





