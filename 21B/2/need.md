# 题目要求
B题 乙醇偶合制备 C4 烯烃
C4 烯烃广泛应用于化工产品及医药的生产,乙醇是生产制备C4 烯烃的原料。 在制备过程中,催化剂组合(即:Co 负载量、Co/SiO2 和 HAP 装料比、乙醇浓度 的组合)与温度对 C4 烯烃的选择性和C4 烯烃收率将产生影响(名词解释见附录)。 因此通过对催化剂组合设计,探索乙醇催化偶合制备 C4 烯烃的工艺条件具有非常 重要的意义和价值。
某化工实验室针对不同催化剂在不同温度下做了一系列实验,结果如附件1和 附件2所示。请通过数学建模完成下列问题:

已经解决：(1) 对附件1中每种催化剂组合,分别研究乙醇转化率、C4 烯烃的选择性与温度的关系,并对附件2中350度时给定的催化剂组合在一次实验不同时间的测试结果进行分析。使用的方法的路径：/Users/Mac/Downloads/Math-Modeling-Practice/21B/1/1-1/quadratic_analysis_with_ilr.py
结论的路径：/Users/Mac/Downloads/Math-Modeling-Practice/21B/1/1-1/1-1二次拟合分析说明.md
已经解决：(2) 对附件2中350度时给定的催化剂组合在一次实验不同时间的测试结果进行分析。使用的方法的路径：/Users/Mac/Downloads/Math-Modeling-Practice/21B/1/1-2/1-2时间序列分析.py
结论的路径：/Users/Mac/Downloads/Math-Modeling-Practice/21B/1/1-2/1-2时间序列分析说明.md
**待解决：(3) 探讨不同催化剂组合及温度对乙醇转化率以及C4 烯烃选择性大小的影响。**


# 背景
- 初步可视化得到催化剂具体成分和乙醇转化率、C4 烯烃选择性之间似乎并无明确关系
- 温度对两者都有正向影响

# 名词解释与附件说明
温度:反应温度。
选择性:某一个产物在所有产物中的占比。
时间:催化剂在乙醇氛围下的反应时间,单位分钟(min)。
Co 负载量:Co 与 SiO2 的重量之比。例如,“Co负载量为1wt%”表示 Co 与 SiO2 的重量之比为1:100,记作“1wt%Co/SiO2”,依次类推。
HAP:一种催化剂载体,中文名称羟基磷灰石。
Co /SiO2 和 HAP 装料比:指 Co/SiO2 和 HAP 的质量比。例如附件1 中编号为 A14 的催化剂组合“33mg 1wt%Co/SiO2-67mg HAP-乙醇浓度 1.68ml/min”指 Co/SiO2 和 HAP 质量比为33mg:67mg 且乙醇按每分钟 1.68 毫升加入,依次类推。
乙醇转化率:单位时间内乙醇的单程转化率,其值为 100%×(乙醇进气量-乙 醇剩余量)/乙醇进气量。
C4 烯烃收率:其值为乙醇转化率 x C4 烯烃的选择性。
附件 1:性能数据表。表中乙烯、C4 烯烃、乙醛、碳数为 4-12 脂肪醇等均为 反应的生成物;编号A1-A14 的催化剂实验中使用装料方式 I,B1~B7的催化剂实 验中使用装料方式Ⅱ。
附件2:350度时给定的某种催化剂组合的测试数据。

# 路径
/Users/Mac/Downloads/Math-Modeling-Practice/21B/附件1.csv
/Users/Mac/Downloads/Math-Modeling-Practice/21B/附件2.csv
附件2处理后：
/Users/Mac/Downloads/Math-Modeling-Practice/21B/2/每组指标.csv
工作目录：/Users/Mac/Downloads/Math-Modeling-Practice/21B/2

# 任务
- 结合题目背景，和「初步思路」，对待解决的问题进行分析。
- 结合「初步思路」，给出代码，注意模块化。
## 初步思路
### 已完成：2.1	单因素影响分析
2.1.1	可视化初步分析
首先对不同影响因素绘制分组箱线图或点图来分析大致影响趋势。
对于温度，绘制乙醇转化率-温度和C4烯烃选择性-温度箱线图，温度按照每25摄氏度分一组。
对于Co负载量，直接按负载量分组绘制乙醇转化率-Co负载量和C4烯烃选择性-Co负载量箱线图。
对于装料质量比，直接绘制乙醇转化率-装料质量比和C4烯烃选择性-装料质量比点图分析大致趋势。
对于乙醇浓度，直接绘制乙醇转化率-乙醇浓度和C4烯烃选择性-乙醇浓度点图分析大致趋势。
2.1.2	定量计算指标分析
为了提高分析客观程度、为多因素联合分析提供基础，对于不同影响因素，分别计算对于乙醇转化率和C4烯烃选择性的以下统计量。
相关系数ρ、p值、关系强度d、非线性显著性p_quad。
其中非线性显著性通过二次回归拟合计算。
### 待解决：2.2 多因素影响分析
2.2.1 建立线性回归方程模型
尝试建立转化率/选择性-影响因素的回归模型，以分析多因素联合作用的模式。
1. 首先进行数据预处理，变量进行标准化处理：
$$X_{std} = \frac{x - \mu_x}{\sigma_x}$$
2. 分割数据集：80%训练集、20%测试集（随机分割，确保温度分布均衡）。
3. 检验自变量共线性，若VIF > 5表示严重共线性，需要加入额外处理。
4. 基础线性模型：
$$
\begin{cases}
转化率 = \beta_0 + \beta_1 T + \beta_2 C_c + \beta_3 R + \beta_4 C_e \\
选择性 = \alpha_0 + \alpha_1 T + \alpha_2 C_c + \alpha_3 R + \alpha_4 C_e
\end{cases}
$$

其中$$T$$为温度，$$C_c$$为Co负载量，$$R$$为装料质量比，$$C_e$$为乙醇浓度。

4. 拟合模型后检验残差正态性、同方差性。

### 2.2.2 引入交互项

引入交互项采用逐步回归的方式，从未引入交互项的线性模型开始，每次引入对模型改进最显著的交互项（如F检验p < 0.05），直到无显著交互项可引入为止。

### 2.2.3 避免过拟合

为防止过拟合，考虑引入正则化方法。
采用贝叶斯信息准则控制变量数量：

$$BIC = n \ln (SSE/n) + k \ln (n)$$
优先采用BIC最小的模型。
保留20%数据留作测试数据集，不作训练，若模型测试集$$R^2$$ > 阈值（例如可定为0.6）则模型可接受。
### 注意
- 在每组指标中，A11为异常样本需要剔除，同时「其他催化剂/备注」这一列也不考虑
- 将计算得出的指标以合理的样式输出，方便后续进行分析

