============================================================
步骤1: 数据预处理与标准化
============================================================
1.1 加载数据...
1.2 剔除A11异常样本...
1.3 合并催化剂信息...
1.4 提取数值特征...
1.5 标准化特征变量...
✓ 数据预处理完成
  - 有效样本数: 109
  - 特征变量数: 4
  - 目标变量: 乙醇转化率(%), C4烯烃选择性(%)
  - 特征标准化: 均值=0, 标准差=1

============================================================
步骤2: 数据集分割
============================================================
2.1 按照 80%-20% 分割训练集和测试集...
✓ 数据分割完成
  - 训练集样本数: 87
  - 测试集样本数: 22
  - 整体温度范围: 250-450°C
  - 分割方式: 随机分割，确保代表性

============================================================
步骤3: 共线性检验 (VIF)
============================================================
3.1 计算方差膨胀因子 (VIF)...
3.2 VIF检验结果:
   特征      VIF 共线性评价
   温度 1.005581    轻微
Co负载量 1.032464    轻微
装料质量比 1.009789    轻微
 乙醇浓度 1.037417    轻微

✓ 所有变量的VIF < 5，共线性问题不严重

============================================================
步骤4: 基础线性模型构建
============================================================
4.1 构建基础线性回归模型...

4.1.1 乙醇转化率回归模型
  训练集 R² = 0.6985, MSE = 176.1377
  测试集 R² = 0.7110, MSE = 79.9749

4.1.2 C4烯烃选择性回归模型
  训练集 R² = 0.5859, MSE = 78.1792
  测试集 R² = 0.4066, MSE = 88.5833

4.2 模型系数分析
   特征     转化率系数     选择性系数
   温度 18.443167 10.137573
Co负载量  1.826841 -2.445425
装料质量比 -1.221131  0.191469
 乙醇浓度 -6.806456 -0.625979

============================================================
步骤5: 残差诊断
============================================================
5.1 计算训练集残差...

5.2 残差正态性检验 (Shapiro-Wilk)
  转化率模型: W = 0.9672, p = 0.0262 (非正态)
  选择性模型: W = 0.8938, p = 0.0000 (非正态)

5.3 残差同方差性检验 (Breusch-Pagan)
  转化率模型: LM = 15.1118, p = 0.0045 (异方差)
  选择性模型: LM = 2.9570, p = 0.5650 (同方差)

5.4 绘制残差诊断图...

============================================================
步骤6: 交互项逐步回归
============================================================
6.1 生成所有可能的二阶交互项...
  可能的交互项数量: 6
    - 温度×Co负载量
    - 温度×装料质量比
    - 温度×乙醇浓度
    - Co负载量×装料质量比
    - Co负载量×乙醇浓度
    - 装料质量比×乙醇浓度

6.2 转化率模型交互项逐步回归...
    基础模型 R² = 0.6985, BIC = 467.76
    第1步: 添加 温度×乙醇浓度
      R² = 0.7140 (+0.0154)
      BIC = 467.65
      p值 = 0.0396
    第2步: 无显著交互项可添加，停止
    最终转化率模型包含交互项: ['温度×乙醇浓度']

6.2 选择性模型交互项逐步回归...
    基础模型 R² = 0.5859, BIC = 397.10
    第1步: 无显著交互项可添加，停止
    最终选择性模型包含交互项: []

============================================================
步骤7: 过拟合控制与模型选择
============================================================
7.1 BIC准则模型比较...
目标变量 模型类型  特征数量    训练集R²    测试集R²        BIC 过拟合风险
 转化率 基础线性     4 0.698532 0.710986 467.763779     低
 转化率 含交互项     5 0.713979 0.705890 467.653646     低
 选择性 基础线性     4 0.585862 0.406586 397.096894     中
 选择性 含交互项     4 0.585862 0.406586 397.096894     中

7.2 正则化方法尝试...
目标变量  Ridge R²  Lasso R²
 转化率  0.716636  0.712465
 选择性  0.410329  0.409417

============================================================
步骤8: 最终模型评估
============================================================

8.1 转化率模型最终评估
  推荐模型: 基础线性模型 (R² = 0.7110)
  可接受性:  可接受

8.2 选择性模型最终评估
  推荐模型: 基础线性模型 (R² = 0.4066)
  可接受性:  需要改进

✓ 分析完成! 生成了4个结果文件

============================================================
分析总结
============================================================

关键发现：
转化率模型发现显著交互项: 温度×乙醇浓度
表明温度与乙醇浓度存在协同效应，高温下乙醇浓度的负向影响可能被放大
选择性模型未发现显著交互项，各因素独立作用
模型性能：
转化率模型: R² = 0.711 - 表现良好
选择性模型: R² = 0.407 - 需要改进

共线性评估: VIF最大值 = 1.037
变量间相互独立，建模可信

模型假设检验：
残差正态性: 转化率未通过 选择性未通过
同方差性: 转化率未通过 选择性通过
建议考虑变量变换或非线性建模

工艺优化建议：
1. 温度仍是最关键因素（系数=18.4），优先优化温度控制
2. 乙醇浓度负向影响显著（系数=-6.8），建议适当降低
3. 注意温度与乙醇浓度的协同效应，避免高温高浓度组合
4. Co负载量和装料比影响相对较小，可作为次要优化参数

============================================================
分析完成，已生成数据文件供进一步分析
============================================================